<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Memory managementcat &#x2F;proc&#x2F;pid&#x2F;maps # 查看当前进程的各段的内存加载信息 1234567891011121314151617#:~$sudo cat &#x2F;proc&#x2F;7&#x2F;maps[sudo] password for yixuan_zhang:00200000-0025a000 r--p 00000000 00:16 562949953">
<meta property="og:type" content="article">
<meta property="og:title" content="Memory management">
<meta property="og:url" content="http://example.com/2023/05/12/11.Memory%20managemnet/index.html">
<meta property="og:site_name" content="boolsatellite">
<meta property="og:description" content="Memory managementcat &#x2F;proc&#x2F;pid&#x2F;maps # 查看当前进程的各段的内存加载信息 1234567891011121314151617#:~$sudo cat &#x2F;proc&#x2F;7&#x2F;maps[sudo] password for yixuan_zhang:00200000-0025a000 r--p 00000000 00:16 562949953">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_14-19-42.png">
<meta property="og:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_14-59-39.png">
<meta property="og:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_15-40-27.png">
<meta property="og:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_16-43-12.png">
<meta property="og:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_16-56-53.png">
<meta property="article:published_time" content="2023-05-11T16:00:00.000Z">
<meta property="article:modified_time" content="2023-05-11T16:00:00.000Z">
<meta property="article:author" content="boolsatellite">
<meta property="article:tag" content="oprating system">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/oprating_system/Snipaste_2023-05-12_14-19-42.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Memory management</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="boolsatellite" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/boolsatellite">Projects</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/05/12/10.deadlock/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/05/11/9.%E7%95%AA%E5%A4%96%20%E5%90%8C%E6%AD%A5%E9%97%AE%E9%A2%98/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2023/05/12/11.Memory%20managemnet/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2023/05/12/11.Memory%20managemnet/&text=Memory management"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2023/05/12/11.Memory%20managemnet/&is_video=false&description=Memory management"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Memory management&body=Check out this article: http://example.com/2023/05/12/11.Memory%20managemnet/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2023/05/12/11.Memory%20managemnet/&name=Memory management&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2023/05/12/11.Memory%20managemnet/&t=Memory management"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Memory-management"><span class="toc-number">1.</span> <span class="toc-text">Memory management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E7%9B%AE%E6%A0%87"><span class="toc-number">1.1.</span> <span class="toc-text">内存管理目标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#main-memory"><span class="toc-number">1.1.1.</span> <span class="toc-text">main memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98"><span class="toc-number">1.1.2.</span> <span class="toc-text">高速缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">保护操作系统和用户进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%9C%B0%E5%9D%80%E5%92%8C%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80"><span class="toc-number">1.2.</span> <span class="toc-text">逻辑地址和物理地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E5%92%8C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.2.1.</span> <span class="toc-text">地址空间和地址转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%8D%95%E5%85%83MMU"><span class="toc-number">1.2.2.</span> <span class="toc-text">内存管理单元MMU</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#contiguous-%E8%BF%9E%E7%BB%AD%E7%9A%84-memory-allocation"><span class="toc-number">1.3.</span> <span class="toc-text">contiguous(连续的) memory allocation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#define"><span class="toc-number">1.3.1.</span> <span class="toc-text">define</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FIXED-SIZED-PARTITION-%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.2.</span> <span class="toc-text">FIXED-SIZED PARTITION 固定大小分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Variable-partition-%E5%8F%AF%E5%8F%98%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.3.</span> <span class="toc-text">Variable partition 可变分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%88%86%E9%85%8D%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">动态存储分配问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2%E5%92%8C%E4%BF%9D%E6%8A%A4"><span class="toc-number">1.3.4.</span> <span class="toc-text">地址转换和保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A2%8E%E7%89%87"><span class="toc-number">1.3.5.</span> <span class="toc-text">碎片</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Memory management
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">boolsatellite</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-05-11T16:00:00.000Z" itemprop="datePublished">2023-05-12</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/oprating-system/" rel="tag">oprating system</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Memory-management"><a href="#Memory-management" class="headerlink" title="Memory management"></a>Memory management</h1><p>cat &#x2F;proc&#x2F;pid&#x2F;maps # 查看当前进程的各段的内存加载信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">:~<span class="variable">$sudo</span> <span class="built_in">cat</span> /proc/7/maps</span></span><br><span class="line">[sudo] password for yixuan_zhang:</span><br><span class="line">00200000-0025a000 r--p 00000000 00:16 562949953668040                    /init</span><br><span class="line">0025a000-0034f000 r-xp 00059000 00:16 562949953668040                    /init</span><br><span class="line">0034f000-00361000 rw-p 0014d000 00:16 562949953668040                    /init</span><br><span class="line">00361000-00363000 rw-p 0015e000 00:16 562949953668040                    /init</span><br><span class="line">00363000-0036a000 rw-p 00000000 00:00 0</span><br><span class="line">020b0000-020b7000 rw-p 00000000 00:00 0                                  [heap]</span><br><span class="line">020b7000-020b9000 rw-p 00000000 00:00 0                                  [heap]</span><br><span class="line">7efc18300000-7efc18301000 ---p 00000000 00:00 0</span><br><span class="line">7efc18301000-7efc18316000 rw-p 00000000 00:00 0</span><br><span class="line">7efc18316000-7efc18317000 ---p 00000000 00:00 0</span><br><span class="line">7efc18317000-7efc1832c000 rw-p 00000000 00:00 0</span><br><span class="line">7ffed4d66000-7ffed4d87000 rw-p 00000000 00:00 0                          [stack]</span><br><span class="line">7ffed4dd8000-7ffed4ddc000 r--p 00000000 00:00 0                          [vvar]</span><br><span class="line">7ffed4ddc000-7ffed4ddd000 r-xp 00000000 00:00 0                          [vdso]</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">起始位置     终止位置     权限 偏移量 主设备号:副设备号  文件inode号        文件路径</span></span><br></pre></td></tr></table></figure>

<p>cat &#x2F;proc&#x2F;pid&#x2F;status # 查看当前进程状态</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">:~<span class="variable">$sudo</span> <span class="built_in">cat</span> /proc/7/status</span></span><br><span class="line">Name:   init</span><br><span class="line">Umask:  0022</span><br><span class="line">State:  S (sleeping)</span><br><span class="line">Tgid:   7</span><br><span class="line">Ngid:   0</span><br><span class="line">Pid:    7</span><br><span class="line">PPid:   1</span><br><span class="line">TracerPid:      0</span><br><span class="line">Uid:    0       0       0       0</span><br><span class="line">Gid:    0       0       0       0</span><br><span class="line">FDSize: 128</span><br><span class="line">Groups:</span><br><span class="line">NStgid: 7</span><br><span class="line">NSpid:  7</span><br><span class="line">NSpgid: 7</span><br><span class="line">NSsid:  7</span><br><span class="line">VmPeak:     1812 kB</span><br><span class="line">VmSize:     1812 kB</span><br><span class="line">VmLck:         0 kB</span><br><span class="line">VmPin:         0 kB</span><br><span class="line">VmHWM:        88 kB</span><br><span class="line">VmRSS:        88 kB</span><br><span class="line">RssAnon:              88 kB</span><br><span class="line">RssFile:               0 kB</span><br><span class="line">RssShmem:              0 kB</span><br><span class="line">VmData:      312 kB</span><br><span class="line">VmStk:       132 kB</span><br><span class="line">VmExe:       980 kB</span><br><span class="line">VmLib:         4 kB</span><br><span class="line">VmPTE:        40 kB</span><br><span class="line">VmSwap:        0 kB</span><br><span class="line">HugetlbPages:          0 kB</span><br><span class="line">CoreDumping:    0</span><br><span class="line">THP_enabled:    1</span><br><span class="line">Threads:        1</span><br><span class="line">SigQ:   0/31282</span><br><span class="line">SigPnd: 0000000000000000</span><br><span class="line">ShdPnd: 0000000000000000</span><br><span class="line">SigBlk: 0000000000010000</span><br><span class="line">SigIgn: fffffffc7ff8fefe</span><br><span class="line">SigCgt: 0000000000010000</span><br><span class="line">CapInh: 0000000000000000</span><br><span class="line">CapPrm: 000001ffffffffff</span><br><span class="line">CapEff: 000001ffffffffff</span><br><span class="line">CapBnd: 000001ffffffffff</span><br><span class="line">CapAmb: 0000000000000000</span><br><span class="line">NoNewPrivs:     0</span><br><span class="line">Seccomp:        0</span><br><span class="line">Seccomp_filters:        0</span><br><span class="line">Speculation_Store_Bypass:       thread vulnerable</span><br><span class="line">Cpus_allowed:   ffff</span><br><span class="line">Cpus_allowed_list:      0-15</span><br><span class="line">Mems_allowed:   1</span><br><span class="line">Mems_allowed_list:      0</span><br><span class="line">voluntary_ctxt_switches:        1</span><br><span class="line">nonvoluntary_ctxt_switches:     0</span><br></pre></td></tr></table></figure>

<h2 id="内存管理目标"><a href="#内存管理目标" class="headerlink" title="内存管理目标"></a>内存管理目标</h2><h3 id="main-memory"><a href="#main-memory" class="headerlink" title="main memory"></a>main memory</h3><ul>
<li>Main memory is central(中心) to the operation of a modern computer  system. </li>
<li>Memory consists(组成) of a large array of bytes, each with its own address(每一个字节都拥有地址).</li>
<li>The CPU fetches(获取) instructions from memory according to the value of  the program counter(PC). These instructions may cause additional(额外的)  loading from and storing to specific(特定的) memory addresses.</li>
<li>A typical(典型的) instruction-execution cycle, for example, first fetches an  instruction from memory. The instruction is then decoded(解码&#x2F;译码) and may  cause operands to be fetched from memory. After the instruction has  been executed on the operands, results may be stored back in  memory.</li>
</ul>
<h3 id="高速缓存"><a href="#高速缓存" class="headerlink" title="高速缓存"></a>高速缓存</h3><ul>
<li>高速缓存是一种存取速度比内存快，但容量比内存小的多的存储器，它可以加快访问物理内存的相对速度。</li>
</ul>
<p><img src="/img/oprating_system/Snipaste_2023-05-12_14-19-42.png"></p>
<p>现代操作系统存在三级缓存，一级缓冲又分为指令缓存和数据缓冲，每个核心内均有二级缓存，三级缓存为所有核心公有</p>
<h3 id="保护操作系统和用户进程"><a href="#保护操作系统和用户进程" class="headerlink" title="保护操作系统和用户进程"></a>保护操作系统和用户进程</h3><ul>
<li>用户进程不可以访问操作系统内存数据，以及用户进程空间之间不能互相影响<ul>
<li>通过硬件实现，因为操作系统一般不干预CPU对内存的访问</li>
<li>base register：基址寄存器，保存一个进程加载到内存空间的起始地址</li>
<li>limit register：限长寄存器，保存这个进程所占空间的长度</li>
<li>上述两个寄存器的值只能被操作系统的特权指令加载，通过这两个寄存器可以确定一个进程的起始地址和结束地址，若访问地址不在这一区间内，操作系统将拒绝访问</li>
</ul>
</li>
</ul>
<h2 id="逻辑地址和物理地址"><a href="#逻辑地址和物理地址" class="headerlink" title="逻辑地址和物理地址"></a>逻辑地址和物理地址</h2><h3 id="地址空间和地址转换"><a href="#地址空间和地址转换" class="headerlink" title="地址空间和地址转换"></a>地址空间和地址转换</h3><ul>
<li>逻辑地址：面向程序的地址，总是从0开始编址，每 一条指令的逻辑地址就是与第1条指令之间的相对偏移，因此逻辑地址也叫相对地址或虚拟地址。</li>
<li>物理地址：内存单元看到的实际地址，也称为绝对地址</li>
<li>所有逻辑地址的集合称为逻辑地址空间，这些逻辑地址对应的所有物理地址集合称为物理地址空间。</li>
<li>地址转换：由逻辑地址转换成物理地址。</li>
</ul>
<h3 id="内存管理单元MMU"><a href="#内存管理单元MMU" class="headerlink" title="内存管理单元MMU"></a>内存管理单元MMU</h3><p>程序在编译时以及加载时均采用逻辑地址（加载时不计算地址，在运行时计算真实地址），只有在运行时才使用真实地址</p>
<ul>
<li>Memory-Management Unit完成逻辑地址到物理地址运行时的转换工作。</li>
<li>在加载时将加载首地址存放在，重定位寄存器（relocation register）或基址寄存器</li>
</ul>
<p><img src="/img/oprating_system/Snipaste_2023-05-12_14-59-39.png"></p>
<p>这解决了进程内存无法移动的问题，只需要将进程对应的重定位寄存器中的修改即可修改进程的加载位置</p>
<h2 id="contiguous-连续的-memory-allocation"><a href="#contiguous-连续的-memory-allocation" class="headerlink" title="contiguous(连续的) memory allocation"></a>contiguous(连续的) memory allocation</h2><h3 id="define"><a href="#define" class="headerlink" title="define"></a>define</h3><ul>
<li>In contiguous memory allocation, each process is  contained in a single section of memory that is  contiguous(相近的) to the section containing the next  process.</li>
<li>进程内部地址是连续的，进程与进程间是连续的</li>
</ul>
<h3 id="FIXED-SIZED-PARTITION-固定大小分区"><a href="#FIXED-SIZED-PARTITION-固定大小分区" class="headerlink" title="FIXED-SIZED PARTITION 固定大小分区"></a>FIXED-SIZED PARTITION 固定大小分区</h3><ul>
<li>Memory is divided(划分) to several(数个) fixed-sized(固定大小的) partitions(分区).  Each partition may contain exactly(恰好) one process.</li>
</ul>
<p>存在一张内存分区表，用于查看分区是否被占用</p>
<p><img src="/img/oprating_system/Snipaste_2023-05-12_15-40-27.png"></p>
<p>当 P1所占用的内存为 6K 那么P1 将加载到 编号为 1 的分区中，此时 1号 分区的 occuiped 将变为 1 表示已经占用，这意味为 1号 分区将不允许有其他进程占用，剩余的 2k 将会浪费掉。浪费掉的空间被称为碎片。这是一种非常早期的分区方案。</p>
<h3 id="Variable-partition-可变分区"><a href="#Variable-partition-可变分区" class="headerlink" title="Variable partition 可变分区"></a>Variable partition 可变分区</h3><ul>
<li>In the variable-partition scheme, the operating system(方案)  keeps two tables indicating(表明) which parts of memory  are available and which are occupied.（这两张表指的是占用表和空闲表）</li>
<li>Initially(初始时), all memory is available for user processes  and is considered(看作) one large block of available  memory, a hole.</li>
<li>Eventually,(最终) as you will see, memory contains a set of  holes of various sizes(不同大小)</li>
</ul>
<p>由于进程的加载与释放这势必会导致内存中出现一系列的孔洞，当相邻两个进程都释放时，所形成的孔洞将合并为一个孔洞</p>
<h4 id="动态存储分配问题"><a href="#动态存储分配问题" class="headerlink" title="动态存储分配问题"></a>动态存储分配问题</h4><ul>
<li>首次适应  分配首个足够大的孔，效率最高</li>
<li>最佳适应  分配最小的足够大的孔，浪费最小</li>
<li>最坏适应  分配最大的孔，产生的剩余孔更可能 被再利用</li>
</ul>
<p>首次分配和最佳分配在执行时间和利用空间方面都好于最坏适应，首次适应的效率优于最佳适应</p>
<h3 id="地址转换和保护"><a href="#地址转换和保护" class="headerlink" title="地址转换和保护"></a>地址转换和保护</h3><ul>
<li>两种连续分配方案的地址转换方式是相似的：  物理地址 &#x3D; 基址 + 逻辑地址</li>
<li>地址保护策略：与限长limit(寄存器)进行比较</li>
</ul>
<p><img src="/img/oprating_system/Snipaste_2023-05-12_16-43-12.png"></p>
<p>CPU在每次依靠MMU内存映射单元计算逻辑地址时，逻辑地址均要与 [0，limit] 范围进行比较（因为都要加基地址故省去），若在这个范围内则进行地址转换（访问物理地址），否则不进行地址转换（抛出异常）</p>
<h3 id="碎片"><a href="#碎片" class="headerlink" title="碎片"></a>碎片</h3><ul>
<li>Fragmentation: some little pieces of memory hardly  to be used.<ul>
<li>internal fragmentation(内部碎片)：针对固定分区来说，就是进程占用的固定分区的内存所导致有剩余内存，这部分内存被称为碎片</li>
<li>external fragmentation(外部碎片)：针对可变分区来说，当所剩孔洞足够小，小到不支持进程分配，那么部分内存被称为碎片</li>
</ul>
</li>
<li>碎片的解决方法：compaction(压缩，紧凑)，只有运行时地址转换才可以执行compaction，compaction的开销较大<br><img src="/img/oprating_system/Snipaste_2023-05-12_16-56-53.png"></li>
</ul>
<p>现代操作系统已经不采用这种内存管理的方案了</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1bf4y147PZ/">https://www.bilibili.com/video/BV1bf4y147PZ/</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">tags</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/boolsatellite">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Memory-management"><span class="toc-number">1.</span> <span class="toc-text">Memory management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E7%9B%AE%E6%A0%87"><span class="toc-number">1.1.</span> <span class="toc-text">内存管理目标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#main-memory"><span class="toc-number">1.1.1.</span> <span class="toc-text">main memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98"><span class="toc-number">1.1.2.</span> <span class="toc-text">高速缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">保护操作系统和用户进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%9C%B0%E5%9D%80%E5%92%8C%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80"><span class="toc-number">1.2.</span> <span class="toc-text">逻辑地址和物理地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E5%92%8C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.2.1.</span> <span class="toc-text">地址空间和地址转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%8D%95%E5%85%83MMU"><span class="toc-number">1.2.2.</span> <span class="toc-text">内存管理单元MMU</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#contiguous-%E8%BF%9E%E7%BB%AD%E7%9A%84-memory-allocation"><span class="toc-number">1.3.</span> <span class="toc-text">contiguous(连续的) memory allocation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#define"><span class="toc-number">1.3.1.</span> <span class="toc-text">define</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FIXED-SIZED-PARTITION-%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.2.</span> <span class="toc-text">FIXED-SIZED PARTITION 固定大小分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Variable-partition-%E5%8F%AF%E5%8F%98%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.3.</span> <span class="toc-text">Variable partition 可变分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%88%86%E9%85%8D%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">动态存储分配问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2%E5%92%8C%E4%BF%9D%E6%8A%A4"><span class="toc-number">1.3.4.</span> <span class="toc-text">地址转换和保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A2%8E%E7%89%87"><span class="toc-number">1.3.5.</span> <span class="toc-text">碎片</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2023/05/12/11.Memory%20managemnet/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2023/05/12/11.Memory%20managemnet/&text=Memory management"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2023/05/12/11.Memory%20managemnet/&is_video=false&description=Memory management"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Memory management&body=Check out this article: http://example.com/2023/05/12/11.Memory%20managemnet/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2023/05/12/11.Memory%20managemnet/&title=Memory management"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2023/05/12/11.Memory%20managemnet/&name=Memory management&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2023/05/12/11.Memory%20managemnet/&t=Memory management"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    boolsatellite
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/boolsatellite">Projects</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SPWV8NBZ00"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-SPWV8NBZ00');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
